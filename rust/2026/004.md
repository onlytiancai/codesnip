å¥½ï¼Œè¿™ä¸€æ­¥**æ­£æ˜¯ä»â€œä¼šå†™ Rustâ€è¿ˆå‘â€œç†è§£ Rust è®¾è®¡â€çš„å…³é”®**ã€‚
æˆ‘ä¼šåœ¨**ä¸å¼•å…¥ trait é«˜çº§è¯­æ³•çš„å‰æä¸‹**ï¼Œå¾ªåºæ¸è¿›åœ°ç»™ä½ ä¸€ä¸ª**æ³›å‹ + é—­åŒ…æ¯”è¾ƒå‡½æ•°**çš„æ’åºç‰ˆæœ¬ï¼Œç„¶åè§£é‡Šæ¯ä¸€å¤„ä½ å¿…é¡»ç†è§£çš„ç‚¹ã€‚

---

## ä¸€ã€å®Œæ•´ä»£ç ï¼ˆæ³›å‹ + é—­åŒ…ï¼‰

```rust
fn main() {
    let mut arr = [5, 2, 9, 1, 3];

    // ä½¿ç”¨é—­åŒ…ä½œä¸ºæ¯”è¾ƒè§„åˆ™
    sort_array(&mut arr, |a, b| a > b);

    print_array(&arr);
}

// æ³›å‹æ’åºå‡½æ•°ï¼Œæ¯”è¾ƒè§„åˆ™ç”±é—­åŒ…å†³å®š
fn sort_array<T, F>(arr: &mut [T], mut cmp: F)
where
    F: FnMut(&T, &T) -> bool,
{
    let len = arr.len();

    for i in 0..len {
        for j in 0..len - 1 - i {
            if cmp(&arr[j], &arr[j + 1]) {
                arr.swap(j, j + 1);
            }
        }
    }
}

// æ³›å‹æ‰“å°å‡½æ•°
fn print_array<T>(arr: &[T])
where
    T: std::fmt::Debug,
{
    for i in 0..arr.len() {
        println!("{:?}", arr[i]);
    }
}
```

---

## äºŒã€é€æ­¥è®²è§£ï¼ˆé‡ç‚¹æ˜¯â€œä¸ºä»€ä¹ˆè¿™ä¹ˆå†™â€ï¼‰

---

## 1ï¸âƒ£ æ³›å‹æ’åºå‡½æ•°çš„å‡½æ•°ç­¾å

```rust
fn sort_array<T, F>(arr: &mut [T], mut cmp: F)
```

æ‹†å¼€çœ‹ï¼š

* `T`ï¼šæ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹
* `F`ï¼šé—­åŒ…çš„ç±»å‹ï¼ˆ**æ¯ä¸ªé—­åŒ…éƒ½æœ‰ç‹¬ä¸€æ— äºŒçš„åŒ¿åç±»å‹**ï¼‰
* `arr: &mut [T]`ï¼š

  * æ¥å—ä»»æ„ç±»å‹
  * ä»»æ„é•¿åº¦æ•°ç»„
* `cmp: F`ï¼š

  * ä¼ å…¥ä¸€ä¸ªâ€œæ¯”è¾ƒè§„åˆ™â€

ğŸ“Œ **Rust ä¸æŠŠé—­åŒ…å½“æ™®é€šå‡½æ•°æŒ‡é’ˆçœ‹å¾…**ï¼Œå®ƒä»¬æ˜¯ç‹¬ç«‹ç±»å‹ã€‚

---

## 2ï¸âƒ£ `where` å­å¥ï¼ˆéå¸¸é‡è¦ï¼‰

```rust
where
    F: FnMut(&T, &T) -> bool,
```

æ„æ€æ˜¯ï¼š

> è¿™ä¸ª `F` å¿…é¡»æ˜¯ä¸€ä¸ª
> æ¥æ”¶ `&T, &T`
> è¿”å› `bool`
> çš„å¯å˜é—­åŒ…

ä¸ºä»€ä¹ˆæ˜¯ `FnMut`ï¼Ÿ

* é—­åŒ… **å¯èƒ½æ•è·å¤–éƒ¨å˜é‡**
* æ•è·å˜é‡åï¼Œé—­åŒ…å†…éƒ¨å¯èƒ½ä¼šè¢«ä¿®æ”¹
* `FnMut` æ˜¯æœ€é€šç”¨ã€æœ€å®‰å…¨çš„é€‰æ‹©

ğŸ“Œ ä¸‰ç§é—­åŒ… traitï¼š

* `Fn`ï¼šåªè¯»
* `FnMut`ï¼šå¯å˜
* `FnOnce`ï¼šåªèƒ½è°ƒç”¨ä¸€æ¬¡

æ’åºä¸€èˆ¬ç”¨ `FnMut`

---

## 3ï¸âƒ£ ä¸ºä»€ä¹ˆæ¯”è¾ƒå‚æ•°æ˜¯ `&T` è€Œä¸æ˜¯ `T`

```rust
cmp(&arr[j], &arr[j + 1])
```

åŸå› éå¸¸å…³é”®ï¼š

* å¦‚æœä¼  `T`

  * å°±è¦ **å¤åˆ¶ / ç§»åŠ¨**
  * å¾ˆå¤šç±»å‹ä¸èƒ½å¤åˆ¶
* ä¼  `&T`

  * ä¸è½¬ç§»æ‰€æœ‰æƒ
  * é€šç”¨ã€å®‰å…¨

è¿™ä¹Ÿæ˜¯ **æ ‡å‡†åº“æ’åºçš„è®¾è®¡æ–¹å¼**

---

## 4ï¸âƒ£ ä½¿ç”¨ `swap` ä»£æ›¿æ‰‹åŠ¨äº¤æ¢

```rust
arr.swap(j, j + 1);
```

* æ ‡å‡†åº“æä¾›
* å®‰å…¨
* ä¸è¦æ±‚ `T: Copy`

å¦‚æœä½ æ‰‹å†™äº¤æ¢ï¼š

```rust
let tmp = arr[j];
```

âŒ å¯¹é `Copy` ç±»å‹ç›´æ¥ç¼–è¯‘å¤±è´¥

---

## 5ï¸âƒ£ åœ¨ `main` ä¸­ä½¿ç”¨é—­åŒ…

```rust
sort_array(&mut arr, |a, b| a > b);
```

è§£é‡Šï¼š

* `|a, b| a > b` æ˜¯ä¸€ä¸ªé—­åŒ…
* ç±»å‹æ˜¯ï¼š`FnMut(&i32, &i32) -> bool`
* å‡åºæ’åº

ä½ å¯ä»¥ç«‹åˆ»æ”¹æˆï¼š

```rust
sort_array(&mut arr, |a, b| a < b); // é™åº
```

---

## 6ï¸âƒ£ æ³›å‹æ‰“å°å‡½æ•°

```rust
fn print_array<T>(arr: &[T])
where
    T: std::fmt::Debug,
```

ä¸ºä»€ä¹ˆè¦ `Debug`ï¼Ÿ

* `println!("{:?}", x)` éœ€è¦
* ç¼–è¯‘å™¨å¿…é¡»çŸ¥é“ `T` å¯ä»¥è¢«æ‰“å°

è¿™æ˜¯ Rust **æ˜¾å¼çº¦æŸ**æ€æƒ³çš„ä½“ç°ã€‚

---

## ä¸‰ã€ä½ ç°åœ¨å·²ç»ç†è§£äº†è¿™äº› Rust æ ¸å¿ƒæ¦‚å¿µ

é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ å·²ç»æ¥è§¦åˆ°ï¼š

* æ³›å‹å‡½æ•°
* `where` çº¦æŸ
* é—­åŒ…ä½œä¸ºå‚æ•°
* `Fn / FnMut`
* å€Ÿç”¨ vs æ‰€æœ‰æƒ
* `swap` çš„è®¾è®¡æ„ä¹‰
* Rust æ ‡å‡†åº“ API é£æ ¼

---

## å››ã€å¯¹ç…§æ ‡å‡†åº“ï¼ˆä½ å·²ç»èƒ½çœ‹æ‡‚äº†ï¼‰

```rust
arr.sort_by(|a, b| a.cmp(b));
```

ä½ ç°åœ¨å·²ç»èƒ½ç†è§£ï¼š

* ä¸ºä»€ä¹ˆç”¨é—­åŒ…
* ä¸ºä»€ä¹ˆå‚æ•°æ˜¯å¼•ç”¨
* ä¸ºä»€ä¹ˆä¸æš´éœ²å…ƒç´ ç§»åŠ¨